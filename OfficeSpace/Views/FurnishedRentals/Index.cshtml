@{
    string array = "[15, 30, 45, ALL]";
}
@model OfficeSpace.Models.FurnishedRentalModel
@{
    ViewBag.Title = "IndexView";
}
<link href="~/Content/bootstrap-table.min.css" rel="stylesheet" />
<link href="~/ContentOld/Theme/Spinner.css" rel="stylesheet" />
<link href="https://cdn.rawgit.com/davidstutz/bootstrap-multiselect/master/dist/css/bootstrap-multiselect.css" rel="stylesheet" type="text/css" />
<script src="https://cdn.rawgit.com/davidstutz/bootstrap-multiselect/master/dist/js/bootstrap-multiselect.js" type="text/javascript"></script>
<link href="~/ContentOld/jquery.dataTables.min.css" rel="stylesheet" />
<script src="~/Scripts/jquery.dataTables.min.js"></script>
<style>

    .fixed-table-toolbar .columns-right {
        margin-top: 0px !important;
    }

    .tblRentalDetailsWrapper {
        max-width: 600px;
        margin: 0 auto;
    }

    #tblRentalDetails th, td {
        white-space: nowrap;
    }

    table.dataTable thead .sorting:after,
    table.dataTable thead .sorting:before,
    table.dataTable thead .sorting_asc:after,
    table.dataTable thead .sorting_asc:before,
    table.dataTable thead .sorting_asc_disabled:after,
    table.dataTable thead .sorting_asc_disabled:before,
    table.dataTable thead .sorting_desc:after,
    table.dataTable thead .sorting_desc:before,
    table.dataTable thead .sorting_desc_disabled:after,
    table.dataTable thead .sorting_desc_disabled:before {
        bottom: .5em;
    }
</style>







<div id="page-wrapper">
    <div class="panel">
        <div>
            <div class="panel-heading red-background-colour">
                <div class="row">
                    <div class="col-lg-4 col-md-4 col-sm-4">
                        <h4><strong>Furnished Rentals </strong></h4>
                    </div>
                    <div class="col-lg-8 col-md-8 col-sm-8"></div>
                </div>
            </div>
            @*<div class="panel-body tableLoader" style="text-align:left;">*@

            @using (Html.BeginForm("Index", "FurnishedRentals", FormMethod.Post, new { id = "FurnishedRentals", @class = "bs-example " }))
            {
                <label for="company" style="color:black">Select Company</label> @Html.ListBoxFor(m => m.SelectedCompanyIds, Model.Companies, new { @class = "listbox", @id = "CompanyListBox", style = "width: 250px;" })
                <a href="@Url.Action("DownloadFile", "FurnishedRentals",new { Flag = Model.Flag,companyName = Model.Company})" title="Export to Excel">
                    &nbsp;&nbsp;   &nbsp;&nbsp;   &nbsp;&nbsp;   &nbsp;&nbsp;   &nbsp;&nbsp;   &nbsp;&nbsp; &nbsp;&nbsp;   &nbsp;&nbsp; &nbsp;&nbsp;   &nbsp;&nbsp; &nbsp;&nbsp;   &nbsp;&nbsp; &nbsp;&nbsp;   &nbsp;&nbsp;
                    <i class="fa fa-file-excel-o" aria-hidden="true"></i>
                    Export to Excel
                </a>

                @*<div class="table-responsive" style="overflow-y:scroll;">*@
                <table id="tblRentalDetails" class="table table-striped table-bordered table-sm " cellspacing="0" width="100%"
                       data-toggle="table"
                       data-toolbar="#toolbar"
                       data-search="false"
                       data-show-columns="false"
                       data-minimum-count-columns="2"
                       data-pagination="true"
                       data-id-field="ID"
                       data-page-size="@ViewBag.pageSize"
                       data-page-list="@array"
                       data-show-footer="false"
                       data-row-style="rowStyle"
                       @*data-fixed-columns="true"
                                   data-fixed-columns-left="4"
                                   data-fixed-columns-right="0"*@>
                    <thead>
                        <tr class="table-heading-font">
                            <th data-sortable="false">SL. No.</th>
                            <th data-sortable="false">Date</th>
                            <th data-sortable="false">City</th>
                            <th data-sortable="false">Company</th>
                            <th data-sortable="false">BO/ RO/ CO_A/ CO</th>
                            <th data-sortable="false">Regional Office</th>
                            <th data-sortable="false">Office Name</th>
                            <th data-sortable="false">
                                Office Location / Address

                            </th>
                            <th data-sortable="false">
                                Rent / Owned
                            </th>

                            <th data-sortable="false">
                                Lease Start Date
                            </th>
                            <th data-sortable="false">
                                Lease Starting Rental Amount (INR)
                            </th>
                            <th data-sortable="false">
                                Rental Escalation %
                            </th>
                            <th data-sortable="false" style="text-wrap:none;width:50px">
                                Escalation Period yrs ( Yly/ 3Yrs/ No Escalation)
                            </th>
                            <th data-sortable="false">
                                Lease Period (In Years)
                            </th>
                            <th data-sortable="false">
                                Lease Closure Date
                            </th>
                            <th data-sortable="false">
                                Security Deposit paid (INR)
                            </th>
                            <th data-sortable="false">
                                Advance Rental Paid (INR)
                            </th>
                            <th data-sortable="false">
                                Total Amount onhold with owner
                            </th>
                            <th data-sortable="false">
                                Fitouts Provided by [ Self / Owner]
                            </th>
                            <th data-sortable="false">
                                Number of_Car Parking Allotted
                            </th>
                            <th data-sortable="false">
                                Notice Period (In Months)
                            </th>
                            <th data-sortable="false">
                                Signage covering Roads
                            </th>
                            <th data-sortable="false">
                                Number of Employee
                            </th>
                            <th data-sortable="false">
                                Super BuiltUp Area (Sq.Ft.)
                            </th>
                            <th data-sortable="false">
                                BuiltUp Area (Sq.Ft.)
                            </th>
                            <th data-sortable="false">
                                Carpet Area (Sq.Ft.)
                            </th>
                            <th data-sortable="false">
                                Rental Area (Sq.Ft.)
                            </th>
                            <th data-sortable="false">
                                Present Rental Cost (INR/ Sq.Ft)
                            </th>
                            <th data-sortable="false">
                                Present Monthly Rental Cost (INR)
                            </th>
                            <th data-sortable="false">
                                Present Monthly Billing (INR)
                            </th>
                            <th data-sortable="false">
                                Rental Cost % to Billing
                            </th>
                            <th data-sortable="false">
                                Present Monthly Maintenance Cost (INR)
                            </th>
                            <th data-sortable="false">
                                Present Avg Monthly Maintenance Cost (INR)
                            </th>
                            <th data-sortable="false">
                                Present Avg Monthly Electricity Cost(INR)
                            </th>
                            <th data-sortable="false">
                                Present Avg_Monthly All_other Costs(INR)
                            </th>
                            <th data-sortable="false">
                                Total_Monthly Avg_Costs on_Rental &_Related (INR)
                            </th>
                            <th data-sortable="false">
                                Name
                            </th>
                            <th data-sortable="false">
                                Email
                            </th>
                            <th data-sortable="false">
                                Mobile
                            </th>
                            <th data-sortable="false">
                                Remarks
                            </th>
                            <th data-sortable="false">Update</th>

                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var detail in Model.BranchDataList)
                        {
                            var indexing = Model.BranchDataList.IndexOf(detail);

                        <tr>

                            <td> @detail.ID </td>
                            <td> @detail.Date </td>
                            <td> @detail.City   </td>
                            <td> @detail.Company </td>
                            <td> @detail.OfficeType  </td>
                            <td> @detail.RegionalOffice  </td>
                            <td> @detail.OfficeName  </td>
                            <td style="text-align:right !important"> @detail.Address  </td>
                            <td> @detail.PropertyType  </td>
                            <td> @detail.LeaseStartDate  </td>
                            <td> @detail.LeaseStartingAmount </td>
                            <td> @detail.RentalEscallation </td>
                            <td> @detail.EscallationPeriod </td>
                            <td> @detail.LeasePeriod   </td>
                            <td> @detail.LeaseClouserDate   </td>
                            <td> @detail.SecurityDeposit   </td>


                            <td> @detail.AdvanceRental </td>
                            <td> @detail.TotalAmountHoldWithOwner </td>
                            <td> @detail.FitOuts   </td>
                            <td> @detail.NoOfCarParking </td>
                            <td> @detail.NoticePeriod  </td>
                            <td> @detail.Signage  </td>
                            <td> @detail.NoOfEmployee  </td>
                            <td> @detail.SuperBuiltUpArea  </td>
                            <td> @detail.BuiltUpArea </td>
                            <td> @detail.CarpetArea </td>
                            <td> @detail.RentalArea </td>
                            <td> @detail.PresentRentalCost   </td>
                            <td> @detail.PresentMonthlyRentalCost   </td>
                            <td> @detail.PresentMonthlyBilling   </td>


                            <td> @detail.RenatlCostPercentage </td>
                            <td> @detail.MonthlyMaintenanceCost </td>
                            <td> @detail.AvgMonthltMaintenanceCost   </td>
                            <td> @detail.MonthlyElectricityCost </td>
                            <td> @detail.MonthlyAllOtherCosts  </td>
                            <td> @detail.TotalMonthlyRentalCost  </td>
                            <td> @detail.Name  </td>
                            <td> @detail.Email  </td>
                            <td> @detail.Mobile </td>
                            <td> @detail.Remarks </td>

                            <td class="text-center"></td>

                        </tr>
                        }

                    </tbody>
                </table>
                @*</div>*@

            }
            @*</div>*@
        </div>
    </div>
    @*</div>*@


    <script src="~/Scripts/bootstrap/bootstrap-table.min.js"></script>
    <script type="text/javascript">
        $(function () {
            var companies = $('.listbox');
            companies.multiselect({
                includeSelectAllOption: true,
                onSelectAll: function (checked) {
                    $("form").first().submit();
                },
                onChange: function (element, checked) {
                    $("form").first().submit();

                },



            }

            );



        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            activeSideNav('FullfilledOffices');
            $("#CompanyList").change(function () {
                this.form.submit();
            })
            $('#tblRentalDetails').DataTable({
                "scrollX": true,
                "scrollY": 400,
                "paging": false,
                "filter": false,
                "info": false,

            });
        });

        function setvalue(id) {
            var checkbox = document.getElementById(id);
            checkbox.value = checkbox.checked;
        }

    </script>
